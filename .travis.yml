language: java
sudo: required
services:
  - docker

before_install:
  - cd hml
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V
  - cd ../hml-naming-server
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V
  - cd ../hml-ronswanson-quotes
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V
  - cd ../hml-zuul-api
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V
  
script:
  - cd ../hml-ronswanson-quotes
  - mvn test -B

after_success:
  - cd ..
  - docker build -t hyde009/hml ./hml
  - docker build -t hyde009/hml-naming-server ./hml-naming-server
  - docker build -t hyde009/hml-ronswanson-quotes ./hml-ronswanson-quotes
  - docker build -t hyde009/hml-zuul-api ./hml-zuul-api
  - echo "$DOCKER_ID" | docker login -u "$DOCKER_PWD" --password-stdin
  - docker push hyde009/hml
  - docker push hyde009/hml-naming-server
  - docker push hyde009/hml-ronswanson-quotes
  - docker push hyde009/hml-zuul-api      

#deploy:
#  provider: elasticbeanstalk
#  region: "us-west-2"
#  app: "SB-RON"
#  env: "SbRon-env"
#  bucket_name: "elasticbeanstalk-us-west-2-671213784911"
#  bucket_path: "SB-RON"
#  on:
#    branch: master
#  access_key_id: $AWS_ACCESS_KEY
#  secret_access_key:
#    secure: "$AWS_SECRET_KEY"

  
